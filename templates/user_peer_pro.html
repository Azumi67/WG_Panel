<!doctype html>
<html lang="en">

<head>
    <meta name="user-token" content="{{ token }}">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Your WireGuard Access</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='vendor/fa/css/all.min.css') }}">
    <link rel="preload" href="{{ url_for('static', filename='fonts/Poppins-Regular.woff2') }}" as="font"
        type="font/woff2" crossorigin>
    <link rel="preload" href="{{ url_for('static', filename='fonts/Poppins-SemiBold.woff2') }}" as="font"
        type="font/woff2" crossorigin>
    <link rel="preload" href="{{ url_for('static', filename='fonts/Poppins-Bold.woff2') }}" as="font" type="font/woff2"
        crossorigin>

    <link rel="stylesheet" href="/static/css/userlink_pro.css" />

    <style>
        :root {
            --auth-bg: #0b1a30;
            --auth-bg2: #14233e;
            --particles-rgb: 43, 52, 83;
            --particles-alpha: .90;
        }

        :root.dark,
        :root[data-theme="dark"],
        body.dark,
        html.dark {
            --auth-bg: #0b1020;
            --auth-bg2: #141b2f;
            --particles-rgb: 170, 188, 230;
            --particles-alpha: .55;
        }

        @media (prefers-color-scheme: light) {
            :root {
                --auth-bg: #eef2f7;
                --auth-bg2: #dde6f2;
            }
        }

        html,
        body {
            height: 100%
        }

        body {
            margin: 0;
            background: linear-gradient(145deg, var(--auth-bg), var(--auth-bg2));
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            text-rendering: optimizeLegibility;
        }

        #bg-particles {
            position: fixed;
            inset: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
            display: block;
        }

        .shell,
        .wrap {
            position: relative;
            z-index: 1;
        }

        .meter.animated span {
            transition: width .35s ease
        }
    </style>
    
    <script defer src="/static/js/qrcode.min.js"></script>
    <script defer src="/static/js/userlink_pro.js"></script>
</head>

<body class="bg-glow">
    <canvas id="bg-particles" aria-hidden="true"></canvas>

    <div class="shell">
        <header class="topbar">
            <div class="brand">
                <i class="fas fa-shield-halved" aria-hidden="true"></i>
                <span>WireGuard Access</span>
            </div>
            <div class="top-actions">
                <button id="theme-toggle" class="icon-btn" title="Toggle theme" aria-label="Toggle theme">
                    <i class="fas fa-moon" aria-hidden="true"></i>
                </button>
            </div>
        </header>

        <main class="card" role="main">
            <section class="summary grid" aria-label="Peer summary">
                <div class="item">
                    <div class="k">Peer</div>
                    <div id="name" class="v">—</div>
                </div>
                <div class="item">
                    <div class="k">Status</div>
                    <div class="v status-chip" id="status" aria-live="polite">
                        <span class="status-indicator"></span>
                        <span class="status-label">—</span>
                    </div>
                </div>
                <div class="item">
                    <div class="k">Address</div>
                    <div id="address" class="v mono">—</div>
                </div>
                <div class="item">
                    <div class="k">Endpoint</div>
                    <div id="endpoint" class="v mono">—</div>
                </div>
            </section>

            <hr class="sep" />

            <section class="stats grid-2" aria-label="Usage and time">
                <div class="stat">
                    <h4><i class="fas fa-clock" aria-hidden="true"></i> Time</h4>
                    <div class="row mb6">
                        <div class="big" id="time-left">00d 00h 00m</div>
                        <div class="sub" id="expires-at">Expires —</div>
                    </div>
                    <div class="meter animated">
                        <span id="time-bar"></span>
                        <div class="pct" id="time-pct">0%</div>
                    </div>
                    <div class="row mt6">
                        <div class="sub" id="time-sub">Countdown to expiry</div>
                    </div>
                </div>

                <div class="stat">
                    <h4><i class="fas fa-database" aria-hidden="true"></i> Data</h4>
                    <div class="row mb6">
                        <div class="big" id="data-left">0 MiB</div>
                        <div class="sub" id="limit-human">0 MiB</div>
                    </div>
                    <div class="meter animated">
                        <span id="usage-bar"></span>
                        <div class="pct" id="data-pct">0%</div>
                    </div>
                    <div class="row mt6">
                        <div class="sub"><span id="used-human">0 MiB</span> used</div>
                    </div>
                </div>
            </section>

            <section class="config" aria-label="Configuration">
                <div class="config-hdr row row-between">
                    <h4 class="row"><i class="fas fa-qrcode" aria-hidden="true"></i>&nbsp;Config</h4>
                    <div class="cfg-actions">
                        <a class="icon-btn solid" id="dl" href="#" download title="Download config">
                            <i class="fas fa-download" aria-hidden="true"></i>
                        </a>
                        <button class="icon-btn ghost" id="copy-config" title="Copy config">
                            <i class="fas fa-clipboard" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
                <div class="config-body">
                    <div class="qr" id="qr" role="img" aria-label="WireGuard configuration QR"></div>
                    <ul class="hints">
                        <li><i class="fas fa-mobile-screen" aria-hidden="true"></i> Scan on mobile WireGuard</li>
                        <li><i class="fas fa-laptop" aria-hidden="true"></i> Desktop: import the <code>.conf</code></li>
                    </ul>
                </div>
            </section>

            <section class="clients" aria-label="Client apps">
                <h4><i class="fas fa-plug" aria-hidden="true"></i> Clients</h4>
                <div class="chips">
                    <a class="chip" href="https://www.wireguard.com/install/" target="_blank" rel="noopener"><i
                            class="fab fa-windows" aria-hidden="true"></i> Windows</a>
                    <a class="chip" href="https://play.google.com/store/apps/details?id=com.wireguard.android"
                        target="_blank" rel="noopener"><i class="fab fa-android" aria-hidden="true"></i> Android</a>
                    <a class="chip" href="https://apps.apple.com/app/wireguard/id1441195209" target="_blank"
                        rel="noopener"><i class="fab fa-apple" aria-hidden="true"></i> iOS</a>
                </div>
            </section>

            <section class="support" aria-label="Support">
                <h4><i class="fas fa-headset" aria-hidden="true"></i> Support</h4>
                {% if support_telegram %}
                <a class="support-link" id="tg-link" target="_blank" rel="noopener"
                    href="https://t.me/{{ support_telegram | replace('@','') }}">
                    <i class="fab fa-telegram" aria-hidden="true"></i><span>{{ support_telegram }}</span>
                </a>
                {% endif %}
            </section>
        </main>

        <footer class="foot">
            <span>Secure tunnel • {{ token }}</span>
        </footer>
    </div>

    <div id="toast-container" aria-live="polite" aria-atomic="true"></div>

    <script>
        (() => {
            const cvs = document.getElementById('bg-particles');
            if (!cvs) return;
            const ctx = cvs.getContext('2d', { alpha: true });
            const DPR = Math.min(window.devicePixelRatio || 1, 2);
            let w = 0, h = 0, pts = [];

            function cssv(n) { return getComputedStyle(document.documentElement).getPropertyValue(n).trim(); }
            function theme() { const rgb = (cssv('--particles-rgb') || '170,188,230').split(',').map(s => +s.trim()); const al = parseFloat(cssv('--particles-alpha') || '0.55') || 0.55; return { rgb, al }; }

            let T = theme();

            function resize() {
                w = cvs.width = Math.floor(innerWidth * DPR);
                h = cvs.height = Math.floor(innerHeight * DPR);
                cvs.style.width = innerWidth + 'px';
                cvs.style.height = innerHeight + 'px';
                const count = Math.min(100, Math.round((innerWidth * innerHeight) / 22000));
                pts = Array.from({ length: count }, () => ({
                    x: Math.random() * w, y: Math.random() * h,
                    vx: (Math.random() - 0.5) * 0.6 * DPR, vy: (Math.random() - 0.5) * 0.6 * DPR,
                    r: 0.8 + Math.random() * 1.6
                }));
            }

            function frame() {
                ctx.clearRect(0, 0, w, h);
                const [PR, PG, PB] = T.rgb;
                ctx.fillStyle = `rgba(${PR},${PG},${PB},${0.35 * T.al / 0.55})`;
                for (const p of pts) {
                    p.x += p.vx; p.y += p.vy;
                    if (p.x < -10) p.x = w + 10; else if (p.x > w + 10) p.x = -10;
                    if (p.y < -10) p.y = h + 10; else if (p.y > h + 10) p.y = -10;
                    ctx.beginPath(); ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2); ctx.fill();
                }
                ctx.lineWidth = 0.8 * DPR;
                for (let i = 0; i < pts.length; i++) {
                    for (let j = i + 1; j < pts.length; j++) {
                        const a = pts[i], b = pts[j], d = Math.hypot(a.x - b.x, a.y - b.y);
                        if (d < 110 * DPR) {
                            ctx.strokeStyle = `rgba(${PR},${PG},${PB},${(1 - d / (110 * DPR)) * (0.30 * T.al / 0.9)})`;
                            ctx.beginPath(); ctx.moveTo(a.x, a.y); ctx.lineTo(b.x, b.y); ctx.stroke();
                        }
                    }
                }
                requestAnimationFrame(frame);
            }

            window.addEventListener('resize', resize, { passive: true });
            new MutationObserver(() => { T = theme(); }).observe(document.documentElement, { attributes: true, attributeFilter: ['class'] });
            resize(); frame();
        })();
        
        window.SOCIALS = {
            telegram: "{{ support_telegram|default('', true) }}",
            whatsapp: "{{ support_whatsapp|default('', true) }}",
            instagram: "{{ support_instagram|default('', true) }}",
            phone: "{{ support_phone|default('', true) }}",
            website: "{{ support_website|default('', true) }}",
            email: "{{ support_email|default('', true) }}"
        };
    </script>

    <noscript>
        <div
            style="position:fixed;inset:0;display:grid;place-items:center;background:#111;color:#fff;font:16px/1.4 system-ui">
            JavaScript is required to view this page.
        </div>
    </noscript>
    <script>window.USER_LINK_TOKEN = "{{ token }}";</script>

</body>

</html>